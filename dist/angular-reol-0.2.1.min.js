/*! angular-reol 22-07-2013 */
(function(){"use strict";angular.module("reol",[]).factory("reol",["$parse",function(n){var r=function r(n){var r=this;n=n||{},this.index={},this.indexes={},angular.forEach(n,function(t,e){r.index[e]={},r.indexes[e]=n[e]})};return r.prototype=[],r.prototype.add=function(n,r){var t,e,i=this;if(r=r||function(n){if(angular.isDefined(n))throw n},!angular.isObject(n)&&!angular.isArray(n))return r(Error("add() requires an object or array of objects")),this;if(angular.isArray(n)){for(t=0,e=n.length;e>t;t++)this.add(n[t]);return this}return this.push(n),angular.forEach(this.indexes,function(r,t){i._addToIndex(t,n)}),r(),this},r.prototype.merge=function(n,r){return this.add(n,r)},r.prototype.find=function(n,r,t){var e,i,o;if(r=r||angular.noop,angular.isString(n))e=n;else if(angular.isObject(n)){for(i in n)if(n.hasOwnProperty(i)){e=i;break}}else if(angular.isDefined(n))throw Error("find() expects a string, an object as the first parameter, or no parameters");return e?(o=this.index[e]?this.findInIndex(e,n[e]):this.findInList(e,n[e],t),angular.isArray(o)||(o=[o]),r(null,o),o):(r(this.toArray()),this.toArray())},r.prototype.findOne=function(n,r){return r=r||angular.noop,this.find(n,function(n,t){r(n,t[0])},!0)[0]},r.prototype._clear=function(n){n=n||angular.noop,this.index={},this.length=0,n()},r.prototype._findIndexInList=function(n,r){var t,e,i=this;for(t=0,e=i.length;e>t;t++)if(i[t].hasOwnProperty(n)&&i[t][n]===r)return t;return-1},r.prototype.remove=function(n,r,t){function e(r,t){a._removeFromIndex(t,n)}var i,o,a=this;if(r=r||angular.noop,!angular.isObject(n)||null===n){if(t&&this.length>1)throw Error("attempt to remove everything from a length > 1 array while specifying to remove only one item");return this._clear(r),void 0}for(i in n)n.hasOwnProperty(i)&&(o=i,angular.forEach(this.indexes,e),this.splice(this._findIndexInList(o,n[o]),1));r()},r.prototype.findInIndex=function(n,r){return this.index[n][angular.toJson(r)]},r.prototype.findInList=function(n,r,t){var e,i,o=[],a=this;for(e=0,i=a.length;i>e&&(!a[e].hasOwnProperty(n)||a[e][n]!==r||(o.push(a[e]),!t));e++);return o},r.prototype.toArray=function(){return Array.apply(this,this)},r.prototype._addToIndex=function(r,t){var e;return t[r]?e=angular.toJson(t[r]):r.indexOf(".")&&(e=angular.toJson(n(r)(t))),angular.isUndefined(e)?!1:this.index[r].hasOwnProperty(e)?!1:(this.index[r][e]=t,!0)},r.prototype._removeFromIndex=function(r,t){var e;return t[r]?e=angular.toJson(t[r]):r.indexOf(".")&&(e=angular.toJson(n(r)(t))),angular.isUndefined(e)?!1:this.index[r].hasOwnProperty(e)?(delete this.index[r][e],!0):!1},function(n){return new r(n)}}])})();